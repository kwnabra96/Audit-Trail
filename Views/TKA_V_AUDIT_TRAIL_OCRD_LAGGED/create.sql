CREATE VIEW "PHAR_PROD"."TKA_V_AUDIT_TRAIL_OCRD_LAGGED" ( "CardCode", "UserSign", "Creator", "UserSign2", "Modifier", "CreateDate", "UpdateDate", "LogInstanc", "previous_Διακριτικός Τίτλος", "current_Διακριτικός Τίτλος", "Διακριτικός Τίτλος", "previous_Λογιστική Ομάδα", "current_Λογιστική Ομάδα", "Λογιστική Ομάδα", "previous_Α.Φ.Μ", "current_Α.Φ.Μ", "Α.Φ.Μ", "previous_Επωνυμία", "current_Επωνυμία", "Επωνυμία", "previous_Ενδοομιλ. Συναλλαγές", "current_Ενδοομιλ. Συναλλαγές", "Ενδοομιλ. Συναλλαγές", "previous_ΈλεγχοςΠιστωτ. Πολιτικής", "current_ΈλεγχοςΠιστωτ. Πολιτικής", "ΈλεγχοςΠιστωτ. Πολιτικής", "previous_Αδραν.ως προς Πίστωση", "current_Αδραν.ως προς Πίστωση", "Αδραν.ως προς Πίστωση", "previous_Αξιολόγηση Πιστοληπτική", "current_Αξιολόγηση Πιστοληπτική", "Αξιολόγηση Πιστοληπτική", "previous_CRM Code", "current_CRM Code", "CRM Code", "previous_Εντός Ρύθμισης", "current_Εντός Ρύθμισης", "Εντός Ρύθμισης", "previous_Κατηγορία Προμηθευτή", "current_Κατηγορία Προμηθευτή", "Κατηγορία Προμηθευτή", "previous_Τύπος Προμηθευτή", "current_Τύπος Προμηθευτή", "Τύπος Προμηθευτή", "previous_Αδραν. Πιστωτή προς πλη", "current_Αδραν. Πιστωτή προς πλη", "Αδραν. Πιστωτή προς πλη", "previous_Κύκλος Πληρωμών", "current_Κύκλος Πληρωμών", "Κύκλος Πληρωμών", "previous_Περιοδικός Έλεγχος", "current_Περιοδικός Έλεγχος", "Περιοδικός Έλεγχος", "previous_Risk Assessment", "current_Risk Assessment", "Risk Assessment", "previous_Compliance Risk Assessm", "current_Compliance Risk Assessm", "Compliance Risk Assessm", "previous_Legal Assessment", "current_Legal Assessment", "Legal Assessment", "previous_IT Assessments", "current_IT Assessments", "IT Assessments", "previous_GDPR Renewal", "current_GDPR Renewal", "GDPR Renewal", "previous_Quality Assessment", "current_Quality Assessment", "Quality Assessment", "previous_1η Κατηγορία Πελάτη", "current_1η Κατηγορία Πελάτη", "1η Κατηγορία Πελάτη", "previous_2η Κατηγορία Πελάτη", "current_2η Κατηγορία Πελάτη", "2η Κατηγορία Πελάτη", "previous_3η Κατηγορία Πελάτη", "current_3η Κατηγορία Πελάτη", "3η Κατηγορία Πελάτη", "previous_Ανήκει σε Όμιλο", "current_Ανήκει σε Όμιλο", "Ανήκει σε Όμιλο", "previous_Όμιλος", "current_Όμιλος", "Όμιλος", "previous_Δημοσιοποίηση Ε.Ο.Φ.", "current_Δημοσιοποίηση Ε.Ο.Φ.", "Δημοσιοποίηση Ε.Ο.Φ.", "previous_ΑΦΜ(Γενικά)", "current_ΑΦΜ(Γενικά)", "ΑΦΜ(Γενικά)", "previous_Κωδικός Επαγγέλματος", "current_Κωδικός Επαγγέλματος", "Κωδικός Επαγγέλματος", "previous_Επάγγελμα", "current_Επάγγελμα", "Επάγγελμα", "previous_Καθεστώς Φ.Π.Α", "current_Καθεστώς Φ.Π.Α", "Καθεστώς Φ.Π.Α", "previous_Α.Φ.Μ (Διευθύνσεις)", "current_Α.Φ.Μ (Διευθύνσεις)", "Α.Φ.Μ (Διευθύνσεις)", "previous_Όροι Πληρωμής", "current_Όροι Πληρωμής", "Όροι Πληρωμής", "previous_Τιμοκατάλογος", "current_Τιμοκατάλογος", "Τιμοκατάλογος", "previous_Πιστωτικό Όριο", "current_Πιστωτικό Όριο", "Πιστωτικό Όριο", "previous_Ομάδες Ισχύουσας Έκπτωσης", "current_Ομάδες Ισχύουσας Έκπτωσης", "Ομάδες Ισχύουσας Έκπτωσης", "previous_Όνομα Τράπεζας", "current_Όνομα Τράπεζας", "Όνομα Τράπεζας", "previous_Τραπεζικός Κωδικός", "current_Τραπεζικός Κωδικός", "Τραπεζικός Κωδικός", "previous_Λ/σμος Τράπεζας", "current_Λ/σμος Τράπεζας", "Λ/σμος Τράπεζας", "previous_Κωδικός BIC/SWIFT", "current_Κωδικός BIC/SWIFT", "Κωδικός BIC/SWIFT", "previous_IBAN", "current_IBAN", "IBAN", "previous_Προτεινόμενο IBAN", "current_Προτεινόμενο IBAN", "Προτεινόμενο IBAN", "previous_Τράπεζα", "current_Τράπεζα", "Τράπεζα", "previous_Λ/σμος Γ/Λ", "current_Λ/σμος Γ/Λ", "Λ/σμος Γ/Λ", "previous_Υποκατάστημα", "current_Υποκατάστημα", "Υποκατάστημα", "previous_IBAN(Εκτέλεση Προγράμματος)", "current_IBAN(Εκτέλεση Προγράμματος)", "IBAN(Εκτέλεση Προγράμματος)", "previous_Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)", "current_Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)", "Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)" ) AS SELECT
	 "CardCode" ,
	 "UserSign" ,
	 "Creator" ,
	 "UserSign2" ,
	 "Modifier" ,
	 "CreateDate" ,
	 "UpdateDate" ,
	 "LogInstanc" ,
	 "previous_Διακριτικός Τίτλος" ,
	 "current_Διακριτικός Τίτλος" ,
	 "Διακριτικός Τίτλος" ,
	 "previous_Λογιστική Ομάδα" ,
	 "current_Λογιστική Ομάδα" ,
	 "Λογιστική Ομάδα" ,
	 "previous_Α.Φ.Μ" ,
	 "current_Α.Φ.Μ" ,
	 "Α.Φ.Μ" ,
	 "previous_Επωνυμία" ,
	 "current_Επωνυμία" ,
	 "Επωνυμία" ,
	 "previous_Ενδοομιλ. Συναλλαγές" ,
	 "current_Ενδοομιλ. Συναλλαγές" ,
	 "Ενδοομιλ. Συναλλαγές" ,
	 "previous_ΈλεγχοςΠιστωτ. Πολιτικής" ,
	 "current_ΈλεγχοςΠιστωτ. Πολιτικής" ,
	 "ΈλεγχοςΠιστωτ. Πολιτικής" ,
	 "previous_Αδραν.ως προς Πίστωση" ,
	 "current_Αδραν.ως προς Πίστωση" ,
	 "Αδραν.ως προς Πίστωση" ,
	 "previous_Αξιολόγηση Πιστοληπτική" ,
	 "current_Αξιολόγηση Πιστοληπτική" ,
	 "Αξιολόγηση Πιστοληπτική" ,
	 "previous_CRM Code" ,
	 "current_CRM Code" ,
	 "CRM Code" ,
	 "previous_Εντός Ρύθμισης" ,
	 "current_Εντός Ρύθμισης" ,
	 "Εντός Ρύθμισης" ,
	 "previous_Κατηγορία Προμηθευτή" ,
	 "current_Κατηγορία Προμηθευτή" ,
	 "Κατηγορία Προμηθευτή" ,
	 "previous_Τύπος Προμηθευτή" ,
	 "current_Τύπος Προμηθευτή" ,
	 "Τύπος Προμηθευτή" ,
	 "previous_Αδραν. Πιστωτή προς πλη" ,
	 "current_Αδραν. Πιστωτή προς πλη" ,
	 "Αδραν. Πιστωτή προς πλη" ,
	 "previous_Κύκλος Πληρωμών" ,
	 "current_Κύκλος Πληρωμών" ,
	 "Κύκλος Πληρωμών" ,
	 "previous_Περιοδικός Έλεγχος" ,
	 "current_Περιοδικός Έλεγχος" ,
	 "Περιοδικός Έλεγχος" ,
	 "previous_Risk Assessment" ,
	 "current_Risk Assessment" ,
	 "Risk Assessment" ,
	 "previous_Compliance Risk Assessm" ,
	 "current_Compliance Risk Assessm" ,
	 "Compliance Risk Assessm" ,
	 "previous_Legal Assessment" ,
	 "current_Legal Assessment" ,
	 "Legal Assessment" ,
	 "previous_IT Assessments" ,
	 "current_IT Assessments" ,
	 "IT Assessments" ,
	 "previous_GDPR Renewal" ,
	 "current_GDPR Renewal" ,
	 "GDPR Renewal" ,
	 "previous_Quality Assessment" ,
	 "current_Quality Assessment" ,
	 "Quality Assessment" ,
	 "previous_1η Κατηγορία Πελάτη" ,
	 "current_1η Κατηγορία Πελάτη" ,
	 "1η Κατηγορία Πελάτη" ,
	 "previous_2η Κατηγορία Πελάτη" ,
	 "current_2η Κατηγορία Πελάτη" ,
	 "2η Κατηγορία Πελάτη" ,
	 "previous_3η Κατηγορία Πελάτη" ,
	 "current_3η Κατηγορία Πελάτη" ,
	 "3η Κατηγορία Πελάτη" ,
	 "previous_Ανήκει σε Όμιλο" ,
	 "current_Ανήκει σε Όμιλο" ,
	 "Ανήκει σε Όμιλο" ,
	 "previous_Όμιλος" ,
	 "current_Όμιλος" ,
	 "Όμιλος" ,
	 "previous_Δημοσιοποίηση Ε.Ο.Φ." ,
	 "current_Δημοσιοποίηση Ε.Ο.Φ." ,
	 "Δημοσιοποίηση Ε.Ο.Φ." ,
	 "previous_ΑΦΜ(Γενικά)" ,
	 "current_ΑΦΜ(Γενικά)" ,
	 "ΑΦΜ(Γενικά)" ,
	 "previous_Κωδικός Επαγγέλματος" ,
	 "current_Κωδικός Επαγγέλματος" ,
	 "Κωδικός Επαγγέλματος" ,
	 "previous_Επάγγελμα" ,
	 "current_Επάγγελμα" ,
	 "Επάγγελμα" ,
	 "previous_Καθεστώς Φ.Π.Α" ,
	 "current_Καθεστώς Φ.Π.Α" ,
	 "Καθεστώς Φ.Π.Α" ,
	 "previous_Α.Φ.Μ (Διευθύνσεις)" ,
	 "current_Α.Φ.Μ (Διευθύνσεις)" ,
	 "Α.Φ.Μ (Διευθύνσεις)" ,
	 "previous_Όροι Πληρωμής" ,
	 "current_Όροι Πληρωμής" ,
	 "Όροι Πληρωμής" ,
	 "previous_Τιμοκατάλογος" ,
	 "current_Τιμοκατάλογος" ,
	 "Τιμοκατάλογος" ,
	 "previous_Πιστωτικό Όριο" ,
	 "current_Πιστωτικό Όριο" ,
	 "Πιστωτικό Όριο" ,
	 "previous_Ομάδες Ισχύουσας Έκπτωσης" ,
	 "current_Ομάδες Ισχύουσας Έκπτωσης" ,
	 "Ομάδες Ισχύουσας Έκπτωσης" ,
	 "previous_Όνομα Τράπεζας" ,
	 "current_Όνομα Τράπεζας" ,
	 "Όνομα Τράπεζας" ,
	 "previous_Τραπεζικός Κωδικός" ,
	 "current_Τραπεζικός Κωδικός" ,
	 "Τραπεζικός Κωδικός" ,
	 "previous_Λ/σμος Τράπεζας" ,
	 "current_Λ/σμος Τράπεζας" ,
	 "Λ/σμος Τράπεζας" ,
	 "previous_Κωδικός BIC/SWIFT" ,
	 "current_Κωδικός BIC/SWIFT" ,
	 "Κωδικός BIC/SWIFT" ,
	 "previous_IBAN" ,
	 "current_IBAN" ,
	 "IBAN" ,
	 "previous_Προτεινόμενο IBAN" ,
	 "current_Προτεινόμενο IBAN" ,
	 "Προτεινόμενο IBAN" ,
	 "previous_Τράπεζα" ,
	 "current_Τράπεζα" ,
	 "Τράπεζα" ,
	 "previous_Λ/σμος Γ/Λ" ,
	 "current_Λ/σμος Γ/Λ" ,
	 "Λ/σμος Γ/Λ" ,
	 "previous_Υποκατάστημα" ,
	 "current_Υποκατάστημα" ,
	 "Υποκατάστημα" ,
	 "previous_IBAN(Εκτέλεση Προγράμματος)" ,
	 "current_IBAN(Εκτέλεση Προγράμματος)" ,
	 "IBAN(Εκτέλεση Προγράμματος)" ,
	 "previous_Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)" ,
	 "current_Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)" ,
	 "Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)" 
FROM ( SELECT
	 m."CardCode",
	 m."UserSign",
	m."Creator",
	m."UserSign2",
	 m."Modifier",
	m."CreateDate",
	m."UpdateDate",
	 m."LogInstanc",
	 LAG(m."CardName") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_Διακριτικός Τίτλος",
	 m."CardName" AS "current_Διακριτικός Τίτλος",
	 CASE WHEN m."CardName" <> LAG(m."CardName") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."CardName" IS NOT NULL 
		AND LAG(m."CardName") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."CardName" IS NULL 
		AND LAG(m."CardName") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Διακριτικός Τίτλος",
	 LAG(m."GroupCode") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_Λογιστική Ομάδα",
	 m."GroupCode" AS "current_Λογιστική Ομάδα",
	 CASE WHEN m."GroupCode" <> LAG(m."GroupCode") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."GroupCode" IS NOT NULL 
		AND LAG(m."GroupCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."GroupCode" IS NULL 
		AND LAG(m."GroupCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Λογιστική Ομάδα",
	 LAG(m."LicTradNum") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_Α.Φ.Μ",
	 m."LicTradNum" AS "current_Α.Φ.Μ",
	 CASE WHEN m."LicTradNum" <> LAG(m."LicTradNum") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."LicTradNum" IS NOT NULL 
		AND LAG(m."LicTradNum") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."LicTradNum" IS NULL 
		AND LAG(m."LicTradNum") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Α.Φ.Μ",
	 LAG("U_TKA_Eponumia") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Επωνυμία",
	 "U_TKA_Eponumia" AS "current_Επωνυμία",
	 CASE WHEN m."U_TKA_Eponumia" <> LAG(m."U_TKA_Eponumia") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_Eponumia" IS NOT NULL 
		AND LAG(m."U_TKA_Eponumia") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_Eponumia" IS NULL 
		AND LAG(m."U_TKA_Eponumia") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Επωνυμία",
	 LAG(m."U_TKA_Endoomilikes") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_Ενδοομιλ. Συναλλαγές",
	 m."U_TKA_Endoomilikes" AS "current_Ενδοομιλ. Συναλλαγές",
	 CASE WHEN m."U_TKA_Endoomilikes" <> LAG(m."U_TKA_Endoomilikes") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_Endoomilikes" IS NOT NULL 
		AND LAG(m."U_TKA_Endoomilikes") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_Endoomilikes" IS NULL 
		AND LAG(m."U_TKA_Endoomilikes") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Ενδοομιλ. Συναλλαγές",
	 LAG(m."U_TKA_PistotikiPolitiki") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_ΈλεγχοςΠιστωτ. Πολιτικής",
	 "U_TKA_PistotikiPolitiki" AS "current_ΈλεγχοςΠιστωτ. Πολιτικής",
	 CASE WHEN m."U_TKA_PistotikiPolitiki" <> LAG(m."U_TKA_PistotikiPolitiki") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_PistotikiPolitiki" IS NOT NULL 
		AND LAG(m."U_TKA_PistotikiPolitiki") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_PistotikiPolitiki" IS NULL 
		AND LAG(m."U_TKA_PistotikiPolitiki") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "ΈλεγχοςΠιστωτ. Πολιτικής",
	 LAG(m."U_TKA_AdranopoiisiPistosis") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Αδραν.ως προς Πίστωση",
	 "U_TKA_AdranopoiisiPistosis" AS "current_Αδραν.ως προς Πίστωση",
	 CASE WHEN m."U_TKA_AdranopoiisiPistosis" <> LAG(m."U_TKA_AdranopoiisiPistosis") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_AdranopoiisiPistosis" IS NOT NULL 
		AND LAG(m."U_TKA_AdranopoiisiPistosis") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_AdranopoiisiPistosis" IS NULL 
		AND LAG(m."U_TKA_AdranopoiisiPistosis") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Αδραν.ως προς Πίστωση",
	 LAG(m."U_TKA_SecurityCode") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Αξιολόγηση Πιστοληπτική",
	 "U_TKA_SecurityCode" AS "current_Αξιολόγηση Πιστοληπτική",
	 CASE WHEN m."U_TKA_SecurityCode" <> LAG(m."U_TKA_SecurityCode") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_SecurityCode" IS NOT NULL 
		AND LAG(m."U_TKA_SecurityCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_SecurityCode" IS NULL 
		AND LAG(m."U_TKA_SecurityCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Αξιολόγηση Πιστοληπτική",
	 LAG(m."U_TKA_CRMCode") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_CRM Code",
	 "U_TKA_CRMCode" AS "current_CRM Code",
	 CASE WHEN m."U_TKA_CRMCode" <> LAG(m."U_TKA_CRMCode") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_CRMCode" IS NOT NULL 
		AND LAG(m."U_TKA_CRMCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_CRMCode" IS NULL 
		AND LAG(m."U_TKA_CRMCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "CRM Code",
	 LAG(m."U_TKA_EntosRithmisis") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Εντός Ρύθμισης",
	 "U_TKA_EntosRithmisis" AS "current_Εντός Ρύθμισης",
	 CASE WHEN m."U_TKA_EntosRithmisis" <> LAG(m."U_TKA_EntosRithmisis") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_EntosRithmisis" IS NOT NULL 
		AND LAG(m."U_TKA_EntosRithmisis") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_EntosRithmisis" IS NULL 
		AND LAG(m."U_TKA_EntosRithmisis") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Εντός Ρύθμισης",
	 LAG(m."U_TKA_Category_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Κατηγορία Προμηθευτή",
	 "U_TKA_Category_DESCR" AS "current_Κατηγορία Προμηθευτή",
	 CASE WHEN m."U_TKA_Category_DESCR" <> LAG(m."U_TKA_Category_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_Category_DESCR" IS NOT NULL 
		AND LAG(m."U_TKA_Category_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_Category_DESCR" IS NULL 
		AND LAG(m."U_TKA_Category_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Κατηγορία Προμηθευτή",
	 LAG(m."U_TKA_Type_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Τύπος Προμηθευτή",
	 "U_TKA_Type_DESCR" AS "current_Τύπος Προμηθευτή",
	 CASE WHEN m."U_TKA_Type_DESCR" <> LAG(m."U_TKA_Type_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_Type_DESCR" IS NOT NULL 
		AND LAG(m."U_TKA_Type_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_Type_DESCR" IS NULL 
		AND LAG(m."U_TKA_Type_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Τύπος Προμηθευτή",
	 LAG(m."U_TKA_PaymentBlock") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Αδραν. Πιστωτή προς πλη",
	 "U_TKA_PaymentBlock" AS "current_Αδραν. Πιστωτή προς πλη",
	 CASE WHEN m."U_TKA_PaymentBlock" <> LAG(m."U_TKA_PaymentBlock") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_PaymentBlock" IS NOT NULL 
		AND LAG(m."U_TKA_PaymentBlock") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_PaymentBlock" IS NULL 
		AND LAG(m."U_TKA_PaymentBlock") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Αδραν. Πιστωτή προς πλη",
	 LAG(m."U_TKA_PaymentCycle") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Κύκλος Πληρωμών",
	 "U_TKA_PaymentCycle" AS "current_Κύκλος Πληρωμών",
	 CASE WHEN m."U_TKA_PaymentCycle" <> LAG(m."U_TKA_PaymentCycle") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_PaymentCycle" IS NOT NULL 
		AND LAG(m."U_TKA_PaymentCycle") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_PaymentCycle" IS NULL 
		AND LAG(m."U_TKA_PaymentCycle") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Κύκλος Πληρωμών",
	 LAG(m."U_TKA_PeriodMonitoring") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Περιοδικός Έλεγχος",
	 "U_TKA_PeriodMonitoring" AS "current_Περιοδικός Έλεγχος",
	 CASE WHEN m."U_TKA_PeriodMonitoring" <> LAG(m."U_TKA_PeriodMonitoring") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_PeriodMonitoring" IS NOT NULL 
		AND LAG(m."U_TKA_PeriodMonitoring") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_PeriodMonitoring" IS NULL 
		AND LAG(m."U_TKA_PeriodMonitoring") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Περιοδικός Έλεγχος",
	 LAG(m."U_TKA_RiskAssesment") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Risk Assessment",
	 "U_TKA_RiskAssesment" AS "current_Risk Assessment",
	 CASE WHEN m."U_TKA_RiskAssesment" <> LAG(m."U_TKA_RiskAssesment") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_RiskAssesment" IS NOT NULL 
		AND LAG(m."U_TKA_RiskAssesment") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_RiskAssesment" IS NULL 
		AND LAG(m."U_TKA_RiskAssesment") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Risk Assessment",
	 LAG(m."U_TKA_ComplianceRiskAssess") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Compliance Risk Assessm",
	 "U_TKA_ComplianceRiskAssess" AS "current_Compliance Risk Assessm",
	 CASE WHEN m."U_TKA_ComplianceRiskAssess" <> LAG(m."U_TKA_ComplianceRiskAssess") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_ComplianceRiskAssess" IS NOT NULL 
		AND LAG(m."U_TKA_ComplianceRiskAssess") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_ComplianceRiskAssess" IS NULL 
		AND LAG(m."U_TKA_ComplianceRiskAssess") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Compliance Risk Assessm",
	 LAG(m."U_TKA_LegalAssess") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Legal Assessment",
	 "U_TKA_LegalAssess" AS "current_Legal Assessment",
	 CASE WHEN m."U_TKA_LegalAssess" <> LAG(m."U_TKA_LegalAssess") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_LegalAssess" IS NOT NULL 
		AND LAG(m."U_TKA_LegalAssess") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_LegalAssess" IS NULL 
		AND LAG(m."U_TKA_LegalAssess") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Legal Assessment",
	 LAG(m."U_TKA_ITAssessments") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_IT Assessments",
	 "U_TKA_ITAssessments" AS "current_IT Assessments",
	 CASE WHEN m."U_TKA_ITAssessments" <> LAG(m."U_TKA_ITAssessments") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_ITAssessments" IS NOT NULL 
		AND LAG(m."U_TKA_ITAssessments") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_ITAssessments" IS NULL 
		AND LAG(m."U_TKA_ITAssessments") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "IT Assessments",
	 LAG(m."U_TKA_GDPR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_GDPR Renewal",
	 m."U_TKA_GDPR" AS "current_GDPR Renewal",
	 CASE WHEN m."U_TKA_GDPR" <> LAG(m."U_TKA_GDPR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_GDPR" IS NOT NULL 
		AND LAG(m."U_TKA_GDPR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_GDPR" IS NULL 
		AND LAG(m."U_TKA_GDPR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "GDPR Renewal",
	 LAG("U_TKA_QualityAssessment") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Quality Assessment",
	 "U_TKA_QualityAssessment" AS "current_Quality Assessment",
	 CASE WHEN m."U_TKA_QualityAssessment" <> LAG(m."U_TKA_QualityAssessment") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_QualityAssessment" IS NOT NULL 
		AND LAG(m."U_TKA_QualityAssessment") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_QualityAssessment" IS NULL 
		AND LAG(m."U_TKA_QualityAssessment") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Quality Assessment",
	 LAG(m."U_TKA_CustCategory_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_1η Κατηγορία Πελάτη",
	 m."U_TKA_CustCategory_DESCR" AS "current_1η Κατηγορία Πελάτη",
	 CASE WHEN m."U_TKA_CustCategory_DESCR" <> LAG(m."U_TKA_CustCategory_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_CustCategory_DESCR" IS NOT NULL 
		AND LAG(m."U_TKA_CustCategory_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_CustCategory_DESCR" IS NULL 
		AND LAG(m."U_TKA_CustCategory_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "1η Κατηγορία Πελάτη",
	 LAG(m."U_TKA_CustSuBCategory") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_2η Κατηγορία Πελάτη",
	 "U_TKA_CustSuBCategory" AS "current_2η Κατηγορία Πελάτη",
	 CASE WHEN m."U_TKA_CustSuBCategory" <> LAG(m."U_TKA_CustSuBCategory") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_CustSuBCategory" IS NOT NULL 
		AND LAG(m."U_TKA_CustSuBCategory") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_CustSuBCategory" IS NULL 
		AND LAG(m."U_TKA_CustSuBCategory") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "2η Κατηγορία Πελάτη",
	 LAG(m."U_TKA_SubCSubCateg") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_3η Κατηγορία Πελάτη",
	 "U_TKA_SubCSubCateg" AS "current_3η Κατηγορία Πελάτη",
	 CASE WHEN m."U_TKA_SubCSubCateg" <> LAG(m."U_TKA_SubCSubCateg") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_SubCSubCateg" IS NOT NULL 
		AND LAG(m."U_TKA_SubCSubCateg") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_SubCSubCateg" IS NULL 
		AND LAG(m."U_TKA_SubCSubCateg") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "3η Κατηγορία Πελάτη",
	 LAG(m."U_TKA_Omilos") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Ανήκει σε Όμιλο",
	 "U_TKA_Omilos" AS "current_Ανήκει σε Όμιλο",
	 CASE WHEN m."U_TKA_Omilos" <> LAG(m."U_TKA_Omilos") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_Omilos" IS NOT NULL 
		AND LAG(m."U_TKA_Omilos") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_Omilos" IS NULL 
		AND LAG(m."U_TKA_Omilos") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Ανήκει σε Όμιλο",
	 LAG(m."U_TKA_OmilosList_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Όμιλος",
	 "U_TKA_OmilosList_DESCR" AS "current_Όμιλος",
	 CASE WHEN m."U_TKA_OmilosList_DESCR" <> LAG(m."U_TKA_OmilosList_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_OmilosList_DESCR" IS NOT NULL 
		AND LAG(m."U_TKA_OmilosList_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_OmilosList_DESCR" IS NULL 
		AND LAG(m."U_TKA_OmilosList_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Όμιλος",
	 LAG(m."U_TKA_EOF_Dimosiop") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Δημοσιοποίηση Ε.Ο.Φ.",
	 "U_TKA_EOF_Dimosiop" AS "current_Δημοσιοποίηση Ε.Ο.Φ.",
	 CASE WHEN m."U_TKA_EOF_Dimosiop" <> LAG(m."U_TKA_EOF_Dimosiop") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_EOF_Dimosiop" IS NOT NULL 
		AND LAG(m."U_TKA_EOF_Dimosiop") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_EOF_Dimosiop" IS NULL 
		AND LAG(m."U_TKA_EOF_Dimosiop") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Δημοσιοποίηση Ε.Ο.Φ.",
	 LAG(m."AddID") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_ΑΦΜ(Γενικά)",
	 "AddID" AS "current_ΑΦΜ(Γενικά)",
	 CASE WHEN m."AddID" <> LAG(m."AddID") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."AddID" IS NOT NULL 
		AND LAG(m."AddID") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."AddID" IS NULL 
		AND LAG(m."AddID") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "ΑΦΜ(Γενικά)",
	 LAG(m."U_TKA_BusinessCode") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Κωδικός Επαγγέλματος",
	 "U_TKA_BusinessCode" AS "current_Κωδικός Επαγγέλματος",
	 CASE WHEN m."U_TKA_BusinessCode" <> LAG(m."U_TKA_BusinessCode") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."U_TKA_BusinessCode" IS NOT NULL 
		AND LAG(m."U_TKA_BusinessCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."U_TKA_BusinessCode" IS NULL 
		AND LAG(m."U_TKA_BusinessCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Κωδικός Επαγγέλματος",
	 LAG(m."Notes") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Επάγγελμα",
	 "Notes" AS "current_Επάγγελμα",
	 CASE WHEN m."Notes" <> LAG(m."Notes") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."Notes" IS NOT NULL 
		AND LAG(m."Notes") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."Notes" IS NULL 
		AND LAG(m."Notes") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Επάγγελμα",
	 LAG(m."County") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Καθεστώς Φ.Π.Α",
	 "County" AS "current_Καθεστώς Φ.Π.Α",
	 CASE WHEN m."County" <> LAG(m."County") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."County" IS NOT NULL 
		AND LAG(m."County") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."County" IS NULL 
		AND LAG(m."County") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Καθεστώς Φ.Π.Α",
	 LAG(m."LicTradNum2") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Α.Φ.Μ (Διευθύνσεις)",
	 "LicTradNum2" AS "current_Α.Φ.Μ (Διευθύνσεις)",
	 CASE WHEN m."LicTradNum2" <> LAG(m."LicTradNum2") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."LicTradNum2" IS NOT NULL 
		AND LAG(m."LicTradNum2") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."LicTradNum2" IS NULL 
		AND LAG(m."LicTradNum2") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Α.Φ.Μ (Διευθύνσεις)",
	 LAG(m."GroupNum_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Όροι Πληρωμής",
	 "GroupNum_DESCR" AS "current_Όροι Πληρωμής",
	 CASE WHEN m."GroupNum_DESCR" <> LAG(m."GroupNum_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."GroupNum_DESCR" IS NOT NULL 
		AND LAG(m."GroupNum_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."GroupNum_DESCR" IS NULL 
		AND LAG(m."GroupNum_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Όροι Πληρωμής",
	 LAG(m."ListNum_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Τιμοκατάλογος",
	 "ListNum_DESCR" AS "current_Τιμοκατάλογος",
	 CASE WHEN m."ListNum_DESCR" <> LAG(m."ListNum_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."ListNum_DESCR" IS NOT NULL 
		AND LAG(m."ListNum_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."ListNum_DESCR" IS NULL 
		AND LAG(m."ListNum_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Τιμοκατάλογος",
	 LAG(m."CreditLine") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Πιστωτικό Όριο",
	 "CreditLine" AS "current_Πιστωτικό Όριο",
	 CASE WHEN m."CreditLine" <> LAG(m."CreditLine") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."CreditLine" IS NOT NULL 
		AND LAG(m."CreditLine") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."CreditLine" IS NULL 
		AND LAG(m."CreditLine") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Πιστωτικό Όριο",
	 LAG(m."DiscRel") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Ομάδες Ισχύουσας Έκπτωσης",
	 "DiscRel" AS "current_Ομάδες Ισχύουσας Έκπτωσης",
	 CASE WHEN m."DiscRel" <> LAG(m."DiscRel") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."DiscRel" IS NOT NULL 
		AND LAG(m."DiscRel") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."DiscRel" IS NULL 
		AND LAG(m."DiscRel") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Ομάδες Ισχύουσας Έκπτωσης",
	 LAG(m."BankCode_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Όνομα Τράπεζας",
	 "BankCode_DESCR" AS "current_Όνομα Τράπεζας",
	 CASE WHEN m."BankCode_DESCR" <> LAG(m."BankCode_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."BankCode_DESCR" IS NOT NULL 
		AND LAG(m."BankCode_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."BankCode_DESCR" IS NULL 
		AND LAG(m."BankCode_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Όνομα Τράπεζας",
	 LAG(m."BankCode") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Τραπεζικός Κωδικός",
	 "BankCode" AS "current_Τραπεζικός Κωδικός",
	 CASE WHEN m."BankCode" <> LAG(m."BankCode") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."BankCode" IS NOT NULL 
		AND LAG(m."BankCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."BankCode" IS NULL 
		AND LAG(m."BankCode") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Τραπεζικός Κωδικός",
	 LAG(m."DflAccount") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_Λ/σμος Τράπεζας",
	 m."DflAccount" AS "current_Λ/σμος Τράπεζας",
	 CASE WHEN m."DflAccount" <> LAG(m."DflAccount") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."DflAccount" IS NOT NULL 
		AND LAG(m."DflAccount") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."DflAccount" IS NULL 
		AND LAG(m."DflAccount") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Λ/σμος Τράπεζας",
	 LAG("DflSwift") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Κωδικός BIC/SWIFT",
	 "DflSwift" AS "current_Κωδικός BIC/SWIFT",
	 CASE WHEN m."DflSwift" <> LAG(m."DflSwift") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."DflSwift" IS NOT NULL 
		AND LAG(m."DflSwift") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."DflSwift" IS NULL 
		AND LAG(m."DflSwift") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Κωδικός BIC/SWIFT",
	 LAG(m."DflIBAN") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") AS "previous_IBAN",
	 m."DflIBAN" AS "current_IBAN",
	 CASE WHEN m."DflIBAN" <> LAG(m."DflIBAN") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."DflIBAN" IS NOT NULL 
		AND LAG(m."DflIBAN") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."DflIBAN" IS NULL 
		AND LAG(m."DflIBAN") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "IBAN",
	 LAG(m."IBAN") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Προτεινόμενο IBAN",
	 "IBAN" AS "current_Προτεινόμενο IBAN",
	 CASE WHEN m."IBAN" <> LAG(m."IBAN") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."IBAN" IS NOT NULL 
		AND LAG(m."IBAN") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."IBAN" IS NULL 
		AND LAG(m."IBAN") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Προτεινόμενο IBAN",
	 LAG(m."HouseBank_DESCR") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Τράπεζα",
	 "HouseBank_DESCR" AS "current_Τράπεζα",
	 CASE WHEN m."HouseBank_DESCR" <> LAG(m."HouseBank_DESCR") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."HouseBank_DESCR" IS NOT NULL 
		AND LAG(m."HouseBank_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."HouseBank_DESCR" IS NULL 
		AND LAG(m."HouseBank_DESCR") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Τράπεζα",
	 LAG(m."HousBnkAct") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Λ/σμος Γ/Λ",
	 "HousBnkAct" AS "current_Λ/σμος Γ/Λ",
	 CASE WHEN m."HousBnkAct" <> LAG(m."HousBnkAct") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."HousBnkAct" IS NOT NULL 
		AND LAG(m."HousBnkAct") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."HousBnkAct" IS NULL 
		AND LAG(m."HousBnkAct") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Λ/σμος Γ/Λ",
	 LAG(m."HousBnkBrn") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Υποκατάστημα",
	 "HousBnkBrn" AS "current_Υποκατάστημα",
	 CASE WHEN m."HousBnkBrn" <> LAG(m."HousBnkBrn") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."HousBnkBrn" IS NOT NULL 
		AND LAG(m."HousBnkBrn") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."HousBnkBrn" IS NULL 
		AND LAG(m."HousBnkBrn") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Υποκατάστημα",
	 LAG(m."HsBnkIBAN") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_IBAN(Εκτέλεση Προγράμματος)",
	 "HsBnkIBAN" AS "current_IBAN(Εκτέλεση Προγράμματος)",
	 CASE WHEN m."HsBnkIBAN" <> LAG(m."HsBnkIBAN") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."HsBnkIBAN" IS NOT NULL 
		AND LAG(m."HsBnkIBAN") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."HsBnkIBAN" IS NULL 
		AND LAG(m."HsBnkIBAN") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "IBAN(Εκτέλεση Προγράμματος)",
	 LAG(m."HsBnkSwift") OVER (PARTITION BY "CardCode" 
		ORDER BY "LogInstanc" ) AS "previous_Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)",
	 "HsBnkSwift" AS "current_Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)",
	 CASE WHEN m."HsBnkSwift" <> LAG(m."HsBnkSwift") OVER (PARTITION BY m."CardCode" 
		ORDER BY m."LogInstanc") 
	OR (m."HsBnkSwift" IS NOT NULL 
		AND LAG(m."HsBnkSwift") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NULL) 
	OR (m."HsBnkSwift" IS NULL 
		AND LAG(m."HsBnkSwift") OVER (PARTITION BY m."CardCode" 
			ORDER BY m."LogInstanc") IS NOT NULL) 
	THEN 'X' 
	ELSE '' 
	END AS "Κωδικός BIC/SWIFT(Εκτέλεση Προγράμματος)" 
	FROM TKA_V_AUDIT_TRAIL_OCRD_ALL_DATA m ) ORDER BY "CardCode",
	 "LogInstanc" WITH READ ONLY
CREATE VIEW "ZTKA_V_B5_BASE_V2" ( "Series_Type",
	 "TransType",
	 "DocEntry",
	 "DocDate",
	 "BASE_REF",
	 "LocCode",
	 "ItemCode",
	 "Lot",
	 "Quantity" ) AS select
	 IFNULL(n."U_B5_Series_Type",
	 '') as "Series_Type",
	 L."TransType",
	 L."CreatedBy" as "DocEntry",
	 cast(L."DocDate" as DATE) as "DocDate",
	 L."BASE_REF",
	 L."LocCode",
	 L."ItemCode",
	 IFNULL(V."Lot",
	 '') as "Lot",
	 IFNULL(V."Quantity",
	 L."InQty"-L."OutQty") as "Quantity" 
FROM OIVL L 
INNER JOIN ( select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OINV --13
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from ORIN --14
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from ODLN --15
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from ORDN --16
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OPCH --18
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from ORPC --19
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OPDN --20
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from ORPD --21
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OIGN --59
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OIGE --60
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OWTR --67
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OIQR --10000071
 
	union all select
	 "DocEntry",
	 "ObjType",
	 "Series" 
	from OIQI --310000001
 ) J on L."TransType" = J."ObjType" 
and L."CreatedBy" = J."DocEntry" join "NNM1" N on J."Series" = N."Series" 
LEFT join "ZTKA_LILLY_LOTS" V on L."CreatedBy" = V."DocEntry" 
and L."TransType" = V."TransType" 
and L."DocLineNum" = V."DocLineNum" 
and L."LocCode" = V."LocCode" 
and L."ItemCode" = V."ItemCode" WITH READ ONLY